# Cozy States : 
<div align="center" >
<img width="1200" alt="image" src="https://github.com/codestates-seb/seb44_main_029/assets/85989215/ba3354c0-b5e6-4c7e-8c65-85db032feb50">
</div>
<br>

 `팀 명` : 육-얼간이: Across the 얼간이-Verse <br>
 `프로젝트명` : Cozy States  <br>
 `프로젝트 기간` : 2023.06.28 - 2023.07.27  <br>
 `배포 링크` :[Cozy States](https://www.cozystates.com/) 서버의 부활을 기다려 주세요....🥲
 
 <br>시각적 테마 선택에 따라 청각적 서비스를 제공받아 심리적 안정감을 도모하는 미디어 서비스<br>

<br>

## ✨ Team Member
|  Team FE  | 한원영 [Leader] |   이지효   |    정희창    |
| :-------: | :---------: | :-------: | :--------: |
| Profile |<img width="150" src="https://avatars.githubusercontent.com/u/85989215?v=4">| <img width="150" src="https://avatars.githubusercontent.com/u/91511828?v=4"> |<img width=150 src="https://github.com/qpwoei0123/CozyStates/assets/85989215/b9fc73cc-c593-4413-9f8b-477c4a6677a0">
| GitHub ID |  [@qpwoei0123](https://github.com/qpwoei0123) | [@dlwl8y](https://github.com/dlwl8y) |  [@HEECHANG96](https://github.com/HEECHANG96) |
|   Role    | 음원재생 컴포넌트 <br> 공통 컴포넌트(Nav) <br> 테마리스트 페이지 <br> 랜딩 페이지 <br> 파일 업로드 기능<br> | 테마 아이템 리스트 <br> 페이지네이션(무한 스크롤) <br> 좋아요 기능 <br> 좋아요 리스트 필터링 <br>  상세 이미지 페이지    |  회원가입    <br>로그인 <br> 프로필 페이지 <br> 회원 정보 조회 / 탈퇴 <br> 좋아요 리스트 조회 / 업데이트 

<br>

|  Team BE  |   이동열 [Leader]  |  조성욱  | 허웅    |
| :-------: | :--------------: | :------: | :---: |
| Profile |<img width="150" src="https://avatars.githubusercontent.com/u/117034592?v=4"> |<img width="150" src="https://avatars.githubusercontent.com/u/70518135?v=4"> | <img width="150" src="https://avatars.githubusercontent.com/u/113077033?v=4"> 
| GitHub ID | [@11dy](https://github.com/11dy) |  [@josungyuk](https://github.com/josungyuk) | [@mins-git](https://github.com/mins-git) |
|   Role    |  AWS EC2 배포 <br> 음원 조회 기능  <br> 음원 업로드 기능  | <br> 회원가입 <br> 회원 이력 관리 <br> JWT, OAuth 로그인  <br> Security | 게시판 CRUD <br> 댓글 CRUD <br> 게시글 좋아요 기능 <br> 이미지 AWS 저장  |


<br>

## 💻 Stacks Used
### Back-end
|   Java   |   Spring   |   Spring Boot   |     MySQL   |   AWS   | 
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
| <div style="display: flex; align-items: flex-start;"><img src="https://techstack-generator.vercel.app/java-icon.svg" alt="icon" width="65" height="65" /></div> | <img alt="spring logo" src="https://www.vectorlogo.zone/logos/springio/springio-icon.svg" height="50" width="50" > | <img alt="spring-boot logo" src="https://t1.daumcdn.net/cfile/tistory/27034D4F58E660F616" width="65" height="65" >  | <div style="display: flex; align-items: flex-start;"><img src="https://techstack-generator.vercel.app/mysql-icon.svg" alt="icon" width="65" height="65" /></div> | <div style="display: flex; align-items: flex-start;"><img src="https://techstack-generator.vercel.app/aws-icon.svg" alt="icon" width="65" height="65" /></div> | 


</br>

### Front-end
|     Html     |     CSS     |     TypeScript     |     React    |     Styled<br>Components     |     axios     |      esLint     | React Query |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------:|:----------------------------------------------------------: |
| <img alt="Html" src ="https://upload.wikimedia.org/wikipedia/commons/thumb/6/61/HTML5_logo_and_wordmark.svg/440px-HTML5_logo_and_wordmark.svg.png" width="65" height="65" /> | <div style="display: flex; align-items: flex-start;"><img src="https://user-images.githubusercontent.com/111227745/210204643-4c3d065c-59ec-481d-ac13-cea795730835.png" alt="CSS" width="50" height="65" /></div> | <div style="display: flex; align-items: flex-start;"><img src="https://techstack-generator.vercel.app/ts-icon.svg" alt="icon" width="75" height="75" /></div> | <div style="display: flex; align-items: flex-start;"><img src="https://techstack-generator.vercel.app/react-icon.svg" alt="icon" width="65" height="65" /></div> | <div style="display: flex; align-items: flex-start;"><img src="https://styled-components.com/logo.png" alt="styled-components icon" width="65" height="65" /></div> | <div style="display: flex; align-items: flex-start;"><img src="https://axios-http.com/assets/logo.svg" width="65" height="65"/></div> | <div style="display: flex; align-items: flex-start;"><img src="https://img.shields.io/badge/ESLint-4B32C3?style=for-the-badge&logo=ESLint&logoColor=white" width="100" height="65" /></div> |<img src="https://images.velog.io/images/woohm402/post/57671ac6-0481-4529-9ed8-eec5d4a2b46a/emblem-light-628080660fddb35787ff6c77e97ca43e.svg" width="75" height="75"/>           |


</br>

### Tools
| Github | Discord | Notion | 
| :--------: | :--------: | :------: |
| <img alt="github logo" src="https://techstack-generator.vercel.app/github-icon.svg" width="65" height="65"> | <img alt="Discord logo" src="https://assets-global.website-files.com/6257adef93867e50d84d30e2/62595384e89d1d54d704ece7_3437c10597c1526c3dbd98c737c2bcae.svg" height="65" width="65"> | <img alt="Notion logo" src="https://www.notion.so/cdn-cgi/image/format=auto,width=640,quality=100/front-static/shared/icons/notion-app-icon-3d.png" height="65" width="65"> |

</br>

## 기여한 부분

- 공통 컴포넌트 (헤더, 네비게이션)
    - 반응형 제작으로 모든 브라우저에서 일관된 모습으로 표시
    - 경로와 토큰에 따라 동적으로 변환됨
- 테마 리스트 페이지
    - 선택된 테마 이미지와 같은 배경을 블러 처리하여 표시
    - 인덱스 선택 로직으로 무한 캐러셀과 유사하게 구현됨
- 랜딩 페이지
    - 애니메이션과 상호작용으로 긍정적인 시각적 효과를 부여
    - 스크롤 비율을 계산하는 함수를 사용하여 스크롤 애니메이션 효과 적용
    - 네비게이션 화살표를 통해 스크롤 이동이 용이함
- 파일 업로드 기능
    - 파일 타입 제한 및 미리보기 기능 추가로 사용자 오류를 방지함
- 음원 재생 컴포넌트
    - 테마 페이지 및 해당 테마에 맞는 음원을 제공하기 위한 쿼리 설계
<br/>

## 피그마
<img width="691" alt="1" src="https://github.com/qpwoei0123/CozyStates/assets/85989215/85d8eeb7-1184-43ac-b579-f5035758d3b5">
<br/>
<br/>

## 개발상세 내용

### **동적 랜딩페이지.**
![2](https://github.com/qpwoei0123/CozyStates/assets/85989215/1b569899-1ef8-4adc-85ca-ae2c283bca28)

- 기존 정적인 랜딩 페이지에서 미디어 서비스의 느낌을 강조하기 위해 동적인 연출이 필요하다고 느꼈습니다.
    스크롤 애니메이션이 필요하다고 생각했고, 외부 라이브러리를 사용하기 이전에 직접 구현해보기로 결정했습니다.
- 페이지 관찰자 를 생성하고 스크롤 이벤트를 감지하여 스크롤 위치에 따라 페이지 관찰자 상태를 변경하도록 구현했습니다.
- 사용자에게 스크롤할 때 의도된 위치에서 애니메이션을 제공하여, 미디어 서비스의 인상을 깊게 준다는 평가를 받았습니다.
<br/>

### React-Query를 사용한 검증 가능한 **음원 컴포넌트.**

```jsx
// themeId가 변경될시 실행되는 쿼리
const { data: musicList, isFetching, isError, isSuccess,} = useQuery([themeId],
 () => GetMusic(themeId), {
		enabled: themeId, // themeId가 존재할 때만 useQuery를 활성화
		onSuccess: () => {
		if (currentMusicId === -1) setCurrentMusicId(0);
	},
	refetchInterval: refetchInterval, // 주기적인 간격으로 데이터를 자동으로 다시 요청합니다.
});
```

- 서버의 presigned URL 정책으로 인해 기존의 음원리소스의 만료시간이 지나면 사용할 수 없는 문제가 발생했습니다
- 당시에 React-Query의 도입을 준비중던 팀원과 의견을 주고받던 중 refetchInterval옵션에 대한 이아디어를 얻어,
    
    React-Query에서 데이터 만료 시점 이전에 재요청하는 방식을 도입함으로서 해결했습니다.
    
- 하지만 돌이켜 본다면, React-Query의 서버상태 감지 기능의 장점을 제대로 이해하지 못한 상태에서
    
    단순히 리소스의 만료시간을 기준으로 해결한 부분은 아쉽다고 생각하고 있습니다.
<br/>

### Local Storage를 활용한 알림창.

![3](https://github.com/qpwoei0123/CozyStates/assets/85989215/9f30d9c5-fcc4-4a41-a9a3-2b047ac3509f)
- 음원이 준비되었을 때 초기 사용자가 음원에 대한 인식을 못하는 경우가 있었습니다.
- 자동 재생은 사용자 경험이 좋지 않다고 판단하여, 음원이 준비되었을 때 재생을 권유하는 알림창을 구현했습니다.
- 추가로 알림창은 초기 사용자가 아니라면 방해 요소가 될 수 있다고 판단하여 Local Storage를 활용하여 사용자가 원한다면 알림창을 다시 보이지 않도록 구현했습니다.
- 사용자 테스트에서 모든 사용자가 음원이 준비됨을 인식했으며, 이후 "다시 보지 않기" 기능이 몰입에 도움을 준다는 평가를 받았습니다.
<br/>

### 이미지 미리보기와 확장자 제한.

![5](https://github.com/qpwoei0123/CozyStates/assets/85989215/90e6d32e-7fc1-410a-b8c2-d51e37151265)

- 파일 업로드 기능을 구현했지만, 업로더의 실수로 원하지 않은 파일이 올라가는 문제가 종종 있었습니다.
- 이러한 업로더의 실수를 문제를 해결하기 위해 두 가지 개선을 생각했습니다.
    - 첫 번째로 업로드 프로세스에서 확장자를 제한했습니다, 이로인해 업로더는 올바른 확장자만 선택이 가능합니다.
    - 두 번째로는 업로드할 파일 미리보기를 구현하여 사용자가 시각적으로 파일을 확인할 수 있도록 했습니다.
- 이후 업로더가 파일을 업로드하기 전에 파일을 한 번 더 체크하도록 되어, 이후로는 실수가 발생하지 않았습니다.
<br/>

### **복잡하고 불편한 기존 코드를 개선하기 위해 노력.**

```jsx
import { setIsModal } from '../feature/header/modalSlice';
import { useDispatch } from 'react-redux';

// 커스텀 훅 버전 사용법
// 1. 가져오기: import { useShowLoginForm } from '나의 경로/hooks/useShowLoginForm';
// 2. 선언하기: const showLoginForm = useShowLoginForm();
// 3. 호출하기: showLoginForm()
export function useShowLoginForm() {
	const dispatch = useDispatch();
	const showLoginForm = () => {
	dispatch(setIsModal(true)); // 로그인 폼을 표시하는 액션 디스패치
};
return showLoginForm;
}
```

- Props Drilling으로 인한 복잡한 로직을 개선하기 위해 Redux를 학습하고 팀원과 함께 스터디를 진행했습니다.
- 또한, Redux의 복잡한 사용과정을 줄이기 위해 커스텀 훅을 만들었고, 이를 팀원과 공유하여  [**코드 품질에 기여**](https://www.notion.so/8b37057eb85c4888a02041f9ad262bdb?pvs=21)했습니다.
<br/>

## 👓 Service

> Main Page

![Large GIF (640x306)](https://github.com/qpwoei0123/CozyStates/assets/85989215/b6ed808a-f368-4a7e-be37-e1197fdf8bc1)
![Large GIF (640x535)](https://github.com/qpwoei0123/CozyStates/assets/85989215/6ed1a90a-d9d5-41e5-a72a-409766033cbf)
![Large GIF (480x585)](https://github.com/qpwoei0123/CozyStates/assets/85989215/dbcf6ef9-635d-4410-b6bb-f177231b0cfd)

<br>

> ThemeList Page

![Large GIF (640x305)](https://github.com/qpwoei0123/CozyStates/assets/85989215/e6314192-bcef-412f-ad96-5672c627a34a)

<br>

> ThemeImageList Page

![Large GIF (640x305)](https://github.com/qpwoei0123/CozyStates/assets/85989215/10b74e1b-98af-4437-9c5e-404e58929cba)

<br>

> ThemeImageDetail Page

![Large GIF (640x305)](https://github.com/qpwoei0123/CozyStates/assets/85989215/8228e877-3975-4308-b703-10ef91edc689)

<br>

> User Page

![Large GIF (640x305)](https://github.com/qpwoei0123/CozyStates/assets/85989215/49feedb0-1290-4a59-83a6-653950c8693b)
![Large GIF (640x292)](https://github.com/qpwoei0123/CozyStates/assets/85989215/622659b1-d5cc-458d-9236-b1c441ed9bda)

<br>

> Admin Upload

![Large GIF (640x291)](https://github.com/qpwoei0123/CozyStates/assets/85989215/2a69ea48-2bbc-44de-8b3f-67dec5eed217)

<br>

> Audio Component

![Large GIF (640x225)](https://github.com/qpwoei0123/CozyStates/assets/85989215/8aff0935-80b6-4216-847d-fdbbfea9ed64)
![Large GIF (640x165)](https://github.com/qpwoei0123/CozyStates/assets/85989215/befbd41a-8bb8-46fe-ade1-663c3ee3c64c)

## 🌱 Git
### branch
> 기능 개발 브랜치에서 작업 후 `Pull Request`하여 병합 진행
- `main` : 배포 브랜치
- `dev` : `fe` / `be` 작업 테스트 병합 브랜치
- `feat/FE` : Front-End 개발 브랜치
- `feat/BE` : Back-End 개발 브랜치
- `feat/FE/기능 이름` : FE 기능 개발 브랜치
- `feat/BE/기능 이름` : BE 기능 개발 브랜치
<br/>

### Commit Convention

Tag | Title
-- | --
feat | 새로운 기능 추가
fix | 버그 수정
docs | 문서 수정
design | CSS 등 사용자 UI 디자인 변경
style | 코드 포맷 변경, 세미 콜록 누락, 코드 수정이 없는 경우
refactor | 코드 리팩토링
test | 테스트 추가, 테스트 리팩토링 추가 (프로덕션 코드 변경 x)
chore | 빌드 테스트 업데이트, 패키지 매니저를 설정 (프로덕션 코드 변경 x)
comment | 필요한 주석 추가 및 변경
rename | 파일 혹은 폴더명을 수정하거나 옮기는 작업만인 경우
remove | 파일을 삭제하는 작업만 수행한 경우
!BREAKING CHANGE | 커다란 API 변경
!HOTFIX | 급하게 치명적인 버그를 고쳐야하는 경우
